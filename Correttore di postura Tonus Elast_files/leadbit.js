!function(){"use strict";var e=function(e){if(this.params=$.extend({comebacker:!1,leadBitDomain:this.queryGET("host")?"http://"+this.queryGET("host")+"/":"http://leadbit.biz/",formDomain:this.queryGET("form_host")?"http://"+this.queryGET("form_host")+"/":"http://leadbit.com/",now:(new Date).getTime(),commentSelector:"",isParked:!1,currentUrl:document.location.hostname+document.location.pathname,apiUrl:"http://"+document.location.hostname+document.location.pathname+"api/",getToExtend:["cb","fblp","lp","fbsop","gclid"]},e),"#devmode"===window.location.hash&&(this.params.leadBitDomain=this.queryGET("host")?"http://"+this.queryGET("host")+"/":"http://devtdbit.biz/",this.params.formDomain=this.queryGET("form_host")?"http://"+this.queryGET("form_host")+"/":"http://devt.leadbit.com/"),this.params.currentUrl=this.params.currentUrl.replace(/\/$/,""),this.queryGET("ver"))window.frameElement||(this.params.isParked=!0,this.getTid());else{var t={v:2,page:this.params.currentUrl,iframe:window!=window.top,callback:"LeadBit.jsonCallback"};this.extendWithGet(this.params.getToExtend,t),this.queryGET("TID")&&(t.TID=this.queryGET("TID")),$.ajax({url:this.params.leadBitDomain+"check-page",data:t,contentType:"application/json",jsonpCallback:"LeadBit.jsonCallback",dataType:"jsonp"})}this.params.commentSelector.length&&this.setCommentsDate(this.params.commentSelector),this.checkTest()};e.prototype={initLayer:function(e){this.params=$.extend(this.params,e),this.replaceLinks(this.params.landing_complete),"object"==typeof this.params.comebacker&&this.initComeBacker(this.params.comebacker)},extendWithGet:function(e,t){for(var a=0;a<e.length;a++){var n=this.queryGET(e[a]);!!n&&(t[e[a]]=n)}return t},mapGetParams:function(){var e={};this.queryGET("utm_medium")&&(e.utm_medium=this.queryGET("utm_medium")),this.queryGET("utm_source")&&(e.utm_source=this.queryGET("utm_source")),this.queryGET("utm_campaign")&&(e.utm_campaign=this.queryGET("utm_campaign")),this.queryGET("utm_term")&&(e.utm_term=this.queryGET("utm_term")),this.queryGET("utm_content")&&(e.utm_content=this.queryGET("utm_content")),this.queryGET("gclid")&&(e.gclid=this.queryGET("gclid")),this.params.data=$.extend(this.params.data,e)},initLanding:function(e){console.log(e),this.params=$.extend(this.params,e);var t,a=this.queryGET("TID")||this.params.TID||this.params.tid||0,n=document.getElementsByTagName("form"),i="";if(this.mapGetParams(),t=this.params.isParked?"api/conversion/new-from-form?TID="+a:this.queryGET("fbsop")?this.params.formDomain+"conversion/new-from-form?TID="+a+"&fbsop="+this.queryGET("fbsop"):this.params.formDomain+"conversion/new-from-form?TID="+a,this.params.flowHash&&(t+="&flowHash="+this.params.flowHash),"object"==typeof this.params.data)for(var r in this.params.data)i+='<input type="hidden" name="'+r+'" value="'+this.params.data[r]+'" />';for(var o=0;o<n.length;o++)n[o].setAttribute("action",t),n[o].setAttribute("method","POST"),n[o].setAttribute("id","order_form"+o),$(n[o]).on("submit",$.proxy(this.validateForm,this)),this.setLandingValueToForm(n[o]),$(n[o]).append(i);a||this.params.TID||!this.params.isParked||"error"===this.params.TID||this.getTid()},setLandingValueToForm:function(e){var t=location.hostname;e.elements.landing?e.elements.landing.value=t:$(e).append('<input type="hidden" name="landing" value="'+t+'" />')},getTid:function(){var e=/\/(\w{4})\//.exec(location.pathname)[1];e.length&&$.ajax({url:"api/tid/"+e,data:{v:2,page:this.params.currentUrl,callback:"LeadBit.getTidCallback",sub1:this.queryGET("sub1"),sub2:this.queryGET("sub2"),sub3:this.queryGET("sub3"),sub4:this.queryGET("sub4"),sub5:this.queryGET("sub5")},contentType:"application/json",jsonpCallback:"LeadBit.getTidCallback",dataType:"jsonp"})},getTidCallback:function(e){this.params.TID=e.tid,e.error&&(this.params.TID="error");for(var t="api/conversion/new-from-form?TID="+e.tid,a=new RegExp("/"),n=(document.location.pathname.replace(a,""),document.forms),i=0;i<n.length;i++)n[i].setAttribute("action",t);e={v:2,page:this.params.currentUrl,iframe:window!=window.top,callback:"LeadBit.jsonCallback"};this.extendWithGet(this.params.getToExtend,e),$.ajax({url:"api/check-page",data:e,contentType:"application/json",jsonpCallback:"LeadBit.jsonCallback",dataType:"jsonp"})},validateForm:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=document.getElementById(e.target.id),a=t.elements.name,n=t.elements.phone,i=t.elements.country,r=!0,o=void 0!==lCountries.countries?lCountries.countries[lCountries.userCountryCode]:{phoneError:"Invalid phone",nameError:"Invalid name",countryError:"Invalid country code"};"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),"in"===lCountries.userCountryCode.toLowerCase()&&(n.value.trim().length<=10&&n.value.trim().length>7&&(alert(o.phoneError),r=!1),t.elements.address&&t.elements.address.value.trim().length>0&&t.elements.address.value.trim().length<5&&(alert("Invalid address"),r=!1)),n.value.trim().length<=7&&(alert(o.phoneError),r=!1),a.value.trim().length<=2&&(alert(o.nameError),r=!1),i.value.length<2&&(alert(o.countryError),r=!1),r&&!this.params.isSubmited&&(t.submit(),this.params.isSubmited=!0)},jsonCallback:function(e){"layer"===e.type?LeadBit.initLayer.call(LeadBit,e):(LeadBit.initLanding.call(LeadBit,e),LeadBit.setData(e))},setData:function(e){e&&e.facebookPixelCodeId&&LeadBit.insertFbId(e.facebookPixelCodeId),e&&e.googleTagId&&LeadBit.insertGoogleTag(e.googleTagId),e&&e.googleAnalyticsId&&LeadBit.insertGoogleAnalytics(e.googleAnalyticsId),e&&e.iframeUrl&&LeadBit.insertIframe(e.iframeUrl),e&&e.PropellerAdsImgPixelLeaving&&LeadBit.insertPropellerImg(e.PropellerAdsImgPixelLeaving)},insertFbId:function(e){var t="\x3c!-- Facebook Pixel Code --\x3e <script>!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod? n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');fbq('init', '"+e+"');fbq('track', 'PageView');<\/script><img height='1' width='1' style='display:none' src='https://www.facebook.com/tr?id="+e+"&ev=PageView&noscript=1'/>";document.body.insertAdjacentHTML("beforeend",t),function(e,t,a,n,i,r,o){e.fbq||(i=e.fbq=function(){i.callMethod?i.callMethod.apply(i,arguments):i.queue.push(arguments)},e._fbq||(e._fbq=i),i.push=i,i.loaded=!0,i.version="2.0",i.queue=[],(r=t.createElement(a)).async=!0,r.src=n,(o=t.getElementsByTagName(a)[0]).parentNode.insertBefore(r,o))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js"),fbq("init",e)},insertGoogleTag:function(e){var t="<noscript><iframe src='//www.googletagmanager.com/ns.html?id="+e+"' height='0' width='0' style='display:none;visibility:hidden'></iframe></noscript> <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','"+e+"');<\/script>";document.body.insertAdjacentHTML("beforeend",t),function(e,t,a,n,i){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var r=t.getElementsByTagName(a)[0],o=t.createElement(a),s="dataLayer"!=n?"&l="+n:"";o.async=!0,o.src="//www.googletagmanager.com/gtm.js?id="+i+s,r.parentNode.insertBefore(o,r)}(window,document,"script","dataLayer",e)},insertGoogleAnalytics:function(e){var t="<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', '"+e+"', 'auto');ga('send', 'pageview');<\/script>";document.body.insertAdjacentHTML("beforeend",t),function(e,t,a,n,i,r,o){e.GoogleAnalyticsObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,r=t.createElement(a),o=t.getElementsByTagName(a)[0],r.async=1,r.src=n,o.parentNode.insertBefore(r,o)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create",e,"auto"),ga("send","pageview")},insertIframe:function(e){var t='<iframe style="position: absolute;left:-9999px;" width="1" scrolling="no" height="1" frameborder="0" src="'+e+'" seamless="seamless">';document.body.insertAdjacentHTML("beforeend",t)},insertPropellerImg:function(e){var t='<img src="'+e+'" frameborder="0" width="1" height="1"/>';document.body.insertAdjacentHTML("beforeend",t)},replaceLinks:function(e){$(function(){$("a").attr({href:e,target:"_blank"})})},setCommentsDate:function(e){var t=this,a=this.params.now;$(e).each(function(e,n){var i=t.randomInt(30,240);a-=60*i*100;var r=new Date(a),o=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()+" "+r.getHours()+":"+r.getMinutes();$(n).html(o)})},initComeBacker:function(e){var t=this,a=document.createElement("script");a.src="/cdn/js/comebacker/comebacker.js",a.onload=function(){t.ComeBacker=new ComeBacker(e)},document.getElementsByTagName("head")[0].appendChild(a)},getCookie:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},setCookie:function(e,t,a){var n=(a=a||{}).expires;if("number"==typeof n&&n){var i=new Date;i.setTime(i.getTime()+1e3*n),n=a.expires=i}n&&n.toUTCString&&(a.expires=n.toUTCString());var r=e+"="+(t=encodeURIComponent(t));for(var o in a){r+="; "+o;var s=a[o];!0!==s&&(r+="="+s)}document.cookie=r},deleteCookie:function(e){this.setCookie(e,"",{expires:-1})},checkTest:function(){$(function(){if("#testleadbit"===window.location.hash){var e=document.createElement("script");e.setAttribute("src","/cdn/js/leadbit_test.js"),document.body.appendChild(e)}})},randomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},queryGET:function(e){if(e=new RegExp("[?&]"+encodeURIComponent(e)+"=([^&]*)").exec(location.search))return e[1]?decodeURIComponent(e[1]):0}},$(function(){window.LeadBit=new e})}();